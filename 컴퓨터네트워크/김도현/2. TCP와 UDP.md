### TCP (Transmission Control Protocol)

**"신뢰성 있는 연결 지향 프로토콜"** - 데이터가 안전하게 도착하는 것이 최우선

### UDP (User Datagram Protocol)

**"빠르고 단순한 비연결 프로토콜"** - 속도가 최우선, 일부 데이터 손실은 감수



---
# 1. TCP 

### 연결형 서비스 특징

**가상 회선 방식**

- 실제 물리적 연결은 아니지만, 논리적으로 전용 통신 경로가 있는 것처럼 동작
- 연결이 설정되면 데이터 순서와 신뢰성이 보장됨

**연결 설정 및 해제**

- **3-Way Handshake**: 연결 설정 시 사용
- **4-Way Handshake**: 연결 해제 시 사용
- 연결 과정에서 양쪽이 서로의 상태를 확인하고 동의해야 통신 시작

### 제어 메커니즘

**흐름 제어 (Flow Control)**

- 송신자가 수신자의 처리 능력을 고려해서 데이터 전송 속도를 조절
- **Window Size**를 통해 구현: 수신자가 "한 번에 이만큼만 보내줘"라고 알려줌
- 수신자의 버퍼 오버플로우를 방지해서 데이터 손실 막음

**혼잡 제어 (Congestion Control)**

- 네트워크 전체의 상황을 고려해서 전송량 조절
- 네트워크가 혼잡하면 전송 속도를 줄여서 전체 네트워크 붕괴 방지
- 개별 연결뿐만 아니라 전체 네트워크의 안정성까지 고려하는 메커니즘

### 신뢰성 보장 메커니즘

**재전송 방식**

1. **Dupack-based retransmission**: 같은 ACK 번호가 여러 번 오면 "중간에 패킷이 빠졌구나"로 판단하고 즉시 재전송
2. **Timeout-based retransmission**: 일정 시간 내에 ACK가 안 오면 "패킷이 분실됐구나"로 판단하고 재전송

이 두 방식으로 네트워크 상황에 관계없이 모든 데이터가 확실히 전달되도록 보장한다.

### TCP 헤더 구조 (20바이트 기본)

|필드|크기|설명|
|---|---|---|
|**Source/Destination Port**|16bit씩|송수신 프로세스의 포트 번호|
|**Sequence Number**|32bit|데이터의 순서 번호, 바이트 단위로 증가|
|**ACK Number**|32bit|다음에 받고 싶은 순서 번호|
|**Data Offset**|4bit|TCP 헤더 크기 (최소 20바이트)|
|**Reserved**|6bit|미래 확장용, 현재는 0으로 설정|
|**Control Flags**|6bit|SYN, ACK, FIN 등 제어 비트|
|**Window Size**|16bit|수신 버퍼 크기, 흐름 제어용|
|**Checksum**|16bit|오류 검출용|
|**Urgent Pointer**|16bit|긴급 데이터 위치|

**주요 제어 비트**

- **SYN**: 연결 설정 요청 (최초 패킷에만 설정)
- **ACK**: 확인 응답 (SYN 이후 모든 패킷에 설정)
- **FIN**: 연결 종료 요청



# UDP

### 비연결형 서비스 특징

**데이터그램 방식**

- 각 패킷이 독립적으로 전송됨
- 연결 설정 과정 없이 바로 데이터 전송 시작
- 서버와 클라이언트 구분이 명확하지 않음 (양쪽 다 데이터 송수신 가능)

**빠른 처리**

- 신호절차가 없어서 즉시 전송 가능
- 헤더가 작고 단순해서 처리 오버헤드 최소화
- 신뢰성 보장 기능이 없는 대신 속도에 특화

### UDP 헤더 구조 (8바이트 고정)

|필드|크기|설명|
|---|---|---|
|**Source Port**|16bit|송신 애플리케이션 포트 번호|
|**Destination Port**|16bit|수신 애플리케이션 포트 번호|
|**Length**|16bit|UDP 헤더 + 데이터 총 길이|
|**Checksum**|16bit|간단한 오류 검사용|

TCP와 비교하면 헤더가 매우 간단합니다. 순서 번호, 확인 번호, 제어 비트 등 신뢰성 관련 필드가 모두 없다.

---

# TCP vs UDP 비교

### 공통점

- **포트 번호 사용**: 둘 다 포트 번호로 프로세스 구분
- **체크섬 제공**: 기본적인 오류 검사 기능 제공
- **전송 계층 프로토콜**: OSI 4계층에서 동작

### 차이점 상세 비교

|특성|TCP|UDP|
|---|---|---|
|**연결 방식**|연결 지향 (3-Way Handshake)|비연결 (즉시 전송)|
|**신뢰성**|높음 (재전송, 순서 보장)|낮음 (재전송 없음)|
|**속도**|느림 (오버헤드 많음)|빠름 (오버헤드 적음)|
|**헤더 크기**|20바이트 이상|8바이트 고정|
|**데이터 경계**|구분 안 함 (스트림)|구분함 (데이터그램)|
|**통신 방식**|1:1 양방향|1:1, 1:N, N:N 모두 가능|
|**브로드캐스트**|불가능|가능|
|**흐름 제어**|있음 (Window Size)|없음|
|**혼잡 제어**|있음|없음|

### 신뢰성 vs 연속성 트레이드오프

**TCP의 특징**

- 신뢰성 ⬆️: 모든 데이터가 확실히 전달됨
- 연속성 ⬇️: 재전송, 순서 맞추기 등으로 지연 발생

**UDP의 특징**

- 신뢰성 ⬇️: 데이터 손실이나 순서 바뀜 가능
- 연속성 ⬆️: 실시간으로 끊김 없는 전송

### 데이터 경계 처리 차이

**TCP (스트림 방식)**

```
송신: "Hello" + "World" → 전송
수신: "HelloWor" + "ld" ← 경계 없이 받아짐
```

**UDP (데이터그램 방식)**

```
송신: "Hello"패킷 + "World"패킷 → 전송  
수신: "Hello"패킷 + "World"패킷 ← 경계 유지됨
```

### TCP를 사용하는 경우

- **웹 브라우징** (HTTP/HTTPS): 정확한 페이지 내용 전달 중요
- **이메일** (SMTP): 메일 내용 손실되면 안 됨
- **파일 전송** (FTP): 파일이 정확해야 함
- **원격 접속** (SSH): 명령어가 정확히 전달되어야 함

### UDP를 사용하는 경우

- **실시간 스트리밍** (YouTube, Netflix): 약간의 화질 저하는 괜찮지만 끊김은 안 됨
- **온라인 게임**: 위치 정보 등은 실시간성이 중요, 과거 데이터는 의미 없음
- **DNS 조회**: 빠른 응답이 중요, 실패하면 다시 요청하면 됨
- **DHCP**: IP 할당 과정에서 빠른 처리 필요









- 참고
https://velog.io/@yun8565/OSI-7%EA%B3%84%EC%B8%B5%EA%B3%BC-TCPIP-4%EA%B3%84%EC%B8%B5